var E=Object.defineProperty;var j=(e,s,i)=>s in e?E(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i;var u=(e,s,i)=>(j(e,typeof s!="symbol"?s+"":s,i),i);import{_ as S}from"./SubmitPrompt-DqUGl_iI.js";import{V as y,t as h,u as O,af as U,a6 as p,co as o,S as f,j as J,i as W,r as $,l as q,d as D,C as T,k as L,_ as N,c as m,a as l,b as v,F as B,K as C,n as I,q as R,o as c,m as _,v as g,am as F,an as H}from"./index-DNh9zwuG.js";import{p as K}from"./data-Csml3z32.js";var M=Object.defineProperty,A=Object.getOwnPropertyDescriptor,V=(e,s,i,t)=>{for(var n=t>1?void 0:t?A(s,i):s,a=e.length-1,b;a>=0;a--)(b=e[a])&&(n=(t?b(s,i,n):b(n))||n);return t&&n&&M(s,i,n),n};function P(e){let s=0;for(;s<e.length;)!e[s].k&&!e[s].v?e.splice(s,1):++s}let k=class extends y{constructor(){super(...arguments);u(this,"userid");u(this,"p",null);u(this,"initialJson");u(this,"editInfo",[]);u(this,"editWebsites",[]);u(this,"submitParams",null);u(this,"t",h)}json(){return JSON.stringify({info:Object.fromEntries(this.p.info),websites:Object.fromEntries(this.p.websites)},null,2)}created(){fetch(O(U(this.userid),"info.json")).then(i=>i.text()).then(i=>{this.p=K(i),this.initialJson=this.json(),this.p.info.forEach(t=>{if(p()==="zh_hans")this.editInfo.push({k:t[0],v:t[1]});else{const n=o[p()];let a;switch(t[0]){case o.zh_hans.alias:a=n.alias;break;case o.zh_hans.age:a=n.age;break;case o.zh_hans.born:a=n.born;break;case o.zh_hans.died:a=n.died;break;case o.zh_hans.location:a=n.location;break;default:a=t[0];break}this.editInfo.push({k:a,v:t[1]})}}),this.p.websites.forEach(t=>this.editWebsites.push({k:t[0],v:t[1]})),this.change()})}change(){for(const i of[this.editInfo,this.editWebsites])i.filter(t=>!t.k&&!t.v).length>1&&P(i),i.filter(t=>!t.k&&!t.v).length==0&&i.push({k:"",v:""})}submitBtn(){P(this.editInfo),P(this.editWebsites),this.p.info=this.editInfo.map(t=>[t.k,t.v]),this.p.websites=this.editWebsites.map(t=>[t.k,t.v]),this.p.info.forEach((t,n)=>{switch(t[0]){case o[p()].age:this.p.info[n][0]=o.zh_hans.age;break;case o[p()].alias:this.p.info[n][0]=o.zh_hans.alias;break;case o[p()].born:this.p.info[n][0]=o.zh_hans.born;break;case o[p()].died:this.p.info[n][0]=o.zh_hans.died;break;case o[p()].location:this.p.info[n][0]=o.zh_hans.location;break}});const i=this.json();if(console.log(i),this.change(),i==this.initialJson){f.fire({title:h.nav_unable_submit,text:"(╯‵□′)╯︵┻━┻",icon:"error",confirmButtonText:h.nav_ok_0,showCloseButton:!1});return}this.submitParams={id:this.p.id,content:i}}submitRequest(i){const t={...this.submitParams,...i};f.fire({title:h.nav_creating_pull_request,text:h.nav_description_pull_request,icon:null,showConfirmButton:!1,didOpen:()=>{f.showLoading(null),J(L+"/edit/info",{method:"POST",params:t}).then(n=>{W(n),f.fire({title:h.nav_success,text:h.nav_success_text,icon:"success",timer:5e3,timerProgressBar:!0,showConfirmButton:!0,confirmButtonText:h.nav_ok_1}).then(a=>{(a.isConfirmed||a.dismiss===f.DismissReason.timer)&&$.push(`/profile/${this.p.id}`)})}).catch(n=>{q(n),f.fire({title:h.nav_failed,text:h.nav_fail_reason+n.message,icon:"error",timer:5e3,timerProgressBar:!0,showConfirmButton:!1})})}}),this.submitParams=null}};V([D()],k.prototype,"userid",2);k=V([T({components:{SubmitPrompt:S}})],k);const z=e=>(F("data-v-f542455a"),e=e(),H(),e),G={id:"container",class:"fbox-vcenter"},Q=z(()=>l("div",{class:"spacer"},null,-1)),X={key:0,id:"EditInfo"},Y={class:"head-text info"},Z={id:"id"},x={class:"fields info"},ee=["onUpdate:modelValue"],se=["onUpdate:modelValue"],te={class:"head-text websites"},ie={class:"fields websites"},ne=["onUpdate:modelValue"],oe=["onUpdate:modelValue"],ae=z(()=>l("div",{class:"spacer"},null,-1));function re(e,s,i,t,n,a){const b=S;return c(),m("div",G,[Q,e.p?(c(),m("div",X,[l("div",Y,v(e.t.nav_profile_card),1),l("div",Z,"@"+v(e.userid),1),l("div",x,[(c(!0),m(B,null,C(e.editInfo,(d,w)=>(c(),m("div",{class:"input-box",key:w},[_(l("input",{class:"key","onUpdate:modelValue":r=>d.k=r,onChange:s[0]||(s[0]=(...r)=>e.change&&e.change(...r))},null,40,ee),[[g,d.k]]),_(l("input",{class:"value","onUpdate:modelValue":r=>d.v=r,onChange:s[1]||(s[1]=(...r)=>e.change&&e.change(...r))},null,40,se),[[g,d.v]])]))),128))]),l("div",te,v(e.t.nav_website),1),l("div",ie,[(c(!0),m(B,null,C(e.editWebsites,(d,w)=>(c(),m("div",{class:"input-box",key:w},[_(l("input",{class:"key","onUpdate:modelValue":r=>d.k=r,onChange:s[2]||(s[2]=(...r)=>e.change&&e.change(...r))},null,40,ne),[[g,d.k]]),_(l("input",{class:"value","onUpdate:modelValue":r=>d.v=r,onChange:s[3]||(s[3]=(...r)=>e.change&&e.change(...r))},null,40,oe),[[g,d.v]])]))),128))]),l("div",{class:"button submit",onClick:s[4]||(s[4]=(...d)=>e.submitBtn&&e.submitBtn(...d))},v(e.t.nav_submit),1)])):I("",!0),ae,e.submitParams?(c(),R(b,{key:1,onSubmit:e.submitRequest,onClose:s[5]||(s[5]=()=>e.submitParams=null)},null,8,["onSubmit"])):I("",!0)])}const ce=N(k,[["render",re],["__scopeId","data-v-f542455a"]]);export{ce as default,P as removeEmpty};
