var E=Object.defineProperty;var j=(s,e,n)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var h=(s,e,n)=>j(s,typeof e!="symbol"?e+"":e,n);import{_ as V}from"./SubmitPrompt-Bdro9t_x.js";import{V as y,t as u,u as O,af as S,a6 as p,cx as o,S as m,j as U,i as J,r as W,l as $,k as D,d as T,C as q,_ as L,c,a as l,n as B,m as N,b as v,F as C,K as I,o as f,p as _,v as g}from"./index-CfTJRNQK.js";import{p as R}from"./data-Csml3z32.js";var F=Object.defineProperty,H=Object.getOwnPropertyDescriptor,z=(s,e,n,t)=>{for(var i=t>1?void 0:t?H(e,n):e,a=s.length-1,b;a>=0;a--)(b=s[a])&&(i=(t?b(e,n,i):b(i))||i);return t&&i&&F(e,n,i),i};function P(s){let e=0;for(;e<s.length;)!s[e].k&&!s[e].v?s.splice(e,1):++e}let k=class extends y{constructor(){super(...arguments);h(this,"userid");h(this,"p",null);h(this,"initialJson");h(this,"editInfo",[]);h(this,"editWebsites",[]);h(this,"submitParams",null);h(this,"t",u)}json(){return JSON.stringify({info:Object.fromEntries(this.p.info),websites:Object.fromEntries(this.p.websites)},null,2)}created(){fetch(O(S(this.userid),"info.json")).then(n=>n.text()).then(n=>{this.p=R(n),this.initialJson=this.json(),this.p.info.forEach(t=>{if(p()==="zh_hans")this.editInfo.push({k:t[0],v:t[1]});else{const i=o[p()];let a;switch(t[0]){case o.zh_hans.alias:a=i.alias;break;case o.zh_hans.age:a=i.age;break;case o.zh_hans.born:a=i.born;break;case o.zh_hans.died:a=i.died;break;case o.zh_hans.location:a=i.location;break;default:a=t[0];break}this.editInfo.push({k:a,v:t[1]})}}),this.p.websites.forEach(t=>this.editWebsites.push({k:t[0],v:t[1]})),this.change()})}change(){for(const n of[this.editInfo,this.editWebsites])n.filter(t=>!t.k&&!t.v).length>1&&P(n),n.filter(t=>!t.k&&!t.v).length==0&&n.push({k:"",v:""})}submitBtn(){P(this.editInfo),P(this.editWebsites),this.p.info=this.editInfo.map(t=>[t.k,t.v]),this.p.websites=this.editWebsites.map(t=>[t.k,t.v]),this.p.info.forEach((t,i)=>{switch(t[0]){case o[p()].age:this.p.info[i][0]=o.zh_hans.age;break;case o[p()].alias:this.p.info[i][0]=o.zh_hans.alias;break;case o[p()].born:this.p.info[i][0]=o.zh_hans.born;break;case o[p()].died:this.p.info[i][0]=o.zh_hans.died;break;case o[p()].location:this.p.info[i][0]=o.zh_hans.location;break}});const n=this.json();if(console.log(n),this.change(),n==this.initialJson){m.fire({title:u.nav_unable_submit,text:"(╯‵□′)╯︵┻━┻",icon:"error",confirmButtonText:u.nav_ok_0,showCloseButton:!1});return}this.submitParams={id:this.p.id,content:n}}submitRequest(n){const t={...this.submitParams,...n};m.fire({title:u.nav_creating_pull_request,text:u.nav_description_pull_request,icon:null,showConfirmButton:!1,didOpen:()=>{m.showLoading(null),U(D+"/edit/info",{method:"POST",params:t}).then(i=>{J(i),m.fire({title:u.nav_success,text:u.nav_success_text,icon:"success",timer:5e3,timerProgressBar:!0,showConfirmButton:!0,confirmButtonText:u.nav_ok_1}).then(a=>{(a.isConfirmed||a.dismiss===m.DismissReason.timer)&&W.push(`/profile/${this.p.id}`)})}).catch(i=>{$(i),m.fire({title:u.nav_failed,text:u.nav_fail_reason+i.message,icon:"error",timer:5e3,timerProgressBar:!0,showConfirmButton:!1})})}}),this.submitParams=null}};z([T()],k.prototype,"userid",2);k=z([q({components:{SubmitPrompt:V}})],k);const K={id:"container",class:"fbox-vcenter"},M={key:0,id:"EditInfo"},x={class:"head-text info"},A={id:"id"},G={class:"fields info"},Q=["onUpdate:modelValue"],X=["onUpdate:modelValue"],Y={class:"head-text websites"},Z={class:"fields websites"},ee=["onUpdate:modelValue"],se=["onUpdate:modelValue"];function te(s,e,n,t,i,a){const b=V;return f(),c("div",K,[e[6]||(e[6]=l("div",{class:"spacer"},null,-1)),s.p?(f(),c("div",M,[l("div",x,v(s.t.nav_profile_card),1),l("div",A,"@"+v(s.userid),1),l("div",G,[(f(!0),c(C,null,I(s.editInfo,(d,w)=>(f(),c("div",{class:"input-box",key:w},[_(l("input",{class:"key","onUpdate:modelValue":r=>d.k=r,onChange:e[0]||(e[0]=(...r)=>s.change&&s.change(...r))},null,40,Q),[[g,d.k]]),_(l("input",{class:"value","onUpdate:modelValue":r=>d.v=r,onChange:e[1]||(e[1]=(...r)=>s.change&&s.change(...r))},null,40,X),[[g,d.v]])]))),128))]),l("div",Y,v(s.t.nav_website),1),l("div",Z,[(f(!0),c(C,null,I(s.editWebsites,(d,w)=>(f(),c("div",{class:"input-box",key:w},[_(l("input",{class:"key","onUpdate:modelValue":r=>d.k=r,onChange:e[2]||(e[2]=(...r)=>s.change&&s.change(...r))},null,40,ee),[[g,d.k]]),_(l("input",{class:"value","onUpdate:modelValue":r=>d.v=r,onChange:e[3]||(e[3]=(...r)=>s.change&&s.change(...r))},null,40,se),[[g,d.v]])]))),128))]),l("div",{class:"button submit",onClick:e[4]||(e[4]=(...d)=>s.submitBtn&&s.submitBtn(...d))},v(s.t.nav_submit),1)])):B("",!0),e[7]||(e[7]=l("div",{class:"spacer"},null,-1)),s.submitParams?(f(),N(b,{key:1,onSubmit:s.submitRequest,onClose:e[5]||(e[5]=()=>s.submitParams=null)},null,8,["onSubmit"])):B("",!0)])}const le=L(k,[["render",te],["__scopeId","data-v-17f3375e"]]);export{le as default,P as removeEmpty};
